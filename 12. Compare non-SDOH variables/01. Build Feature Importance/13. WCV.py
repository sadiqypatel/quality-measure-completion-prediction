# Databricks notebook source
comparison = [
    'numeric_features_saServRate', 'numeric_features_saFacRate', 'numeric_features_mhTreatRate', 'numeric_features_popDensity', 'numeric_features_povRate', 'numeric_features_publicAssistRate', 'numeric_features_highSchoolGradRate', 'numeric_features_goodAirDays', 'numeric_features_injDeathRate', 'numeric_features_urgentCareRate', 'numeric_features_drugdeathRate', 'numeric_features_100HeatDays', 'numeric_features_aprnRate','categorical_features_race_Vec_asian', 'categorical_features_race_Vec_native', 'categorical_features_race_Vec_hawaiian', 'categorical_features_race_Vec_multiracial', 'categorical_features_houseSize_Vec_missing', 'categorical_features_houseSize_Vec_single', 'categorical_features_houseSize_Vec_twoToFive', 'categorical_features_houseSize_Vec_sixorMore', 'categorical_features_fedPovLine_Vec_missing', 'categorical_features_fedPovLine_Vec_0To100', 'categorical_features_fedPovLine_Vec_100To200', 'categorical_features_fedPovLine_Vec_200AndMore', 'categorical_features_speakEnglish_Vec_missing', 'categorical_features_speakEnglish_Vec_yes', 'categorical_features_speakEnglish_Vec_no', 'categorical_features_married_Vec_missing', 'categorical_features_married_Vec_no', 'categorical_features_married_Vec_yes', 'categorical_features_UsCitizen_Vec_yes', 'categorical_features_UsCitizen_Vec_missing', 'categorical_features_UsCitizen_Vec_no', 'categorical_features_ssi_Vec_no', 'categorical_features_ssi_Vec_missing', 'categorical_features_ssi_Vec_yes', 'categorical_features_ssdi_Vec_no', 'categorical_features_ssdi_Vec_missing', 'categorical_features_ssdi_Vec_yes', 'categorical_features_tanf_Vec_no', 'categorical_features_tanf_Vec_missing', 'categorical_features_tanf_Vec_yes', 'categorical_features_disabled_Vec_no', 'categorical_features_disabled_Vec_yes'
]

# COMMAND ----------

input_data = """

numeric_features_INJ017, 23.159738540649414
numeric_features_PC031O, 9.143599510192871
numeric_features_A6, 7.057132244110107
numeric_features_CIR026, 5.016277313232422
numeric_features_E01754800101, 4.740126132965088
numeric_features_DE020N, 4.521433353424072
numeric_features_DE016N, 4.5096435546875
numeric_features_E01757960101, 4.49828577041626
numeric_features_E01757220203, 4.310455322265625
categorical_features_race_Vec_missing, 4.3072509765625
numeric_features_PC002O, 4.269540309906006
numeric_features_03, 4.260592937469482
categorical_features_state_Vec_HI, 4.212569713592529
numeric_features_E01754930101, 4.133401393890381
numeric_features_94, 4.0980119705200195
numeric_features_PE000M, 4.085449695587158
numeric_features_83, 4.044775009155273
numeric_features_GEN004, 4.022983551025391
numeric_features_PM044M, 4.0196099281311035
numeric_features_E01758450101, 4.014615058898926
numeric_features_E01754630201, 4.0048370361328125
numeric_features_E01755210101, 3.972726821899414
numeric_features_E01754880101, 3.966059684753418
numeric_features_E01754840101, 3.9650797843933105
numeric_features_E01754670101, 3.9598968029022217
numeric_features_E01758250302, 3.9419195652008057
numeric_features_95, 3.9363512992858887
categorical_features_houseSize_Vec_twoToFive, 3.9357974529266357
categorical_features_state_Vec_ME, 3.9349565505981445
numeric_features_A4, 3.930356502532959
numeric_features_A0, 3.9274003505706787
numeric_features_PO022M, 3.9186832904815674
numeric_features_PC000O, 3.8983237743377686
numeric_features_E01754200101, 3.8730976581573486
categorical_features_UsCitizen_Vec_no, 3.8382458686828613
numeric_features_OB000N, 3.819903612136841
numeric_features_DC000N, 3.81890869140625
numeric_features_E01754770101, 3.8152594566345215
numeric_features_PRG015, 3.813976287841797
numeric_features_E01754260101, 3.8132238388061523
numeric_features_E01759500101, 3.8053553104400635
numeric_features_PC002M, 3.7981812953948975
numeric_features_71, 3.7975234985351562
numeric_features_89, 3.7889485359191895
numeric_features_E01754910101, 3.7864415645599365
categorical_features_state_Vec_KS, 3.7798540592193604
categorical_features_married_Vec_yes, 3.7712860107421875
numeric_features_CIR038, 3.7636680603027344
numeric_features_91, 3.761702299118042
numeric_features_DF003N, 3.757150411605835
numeric_features_INJ016, 3.7531330585479736
numeric_features_E01758850101, 3.7510976791381836
numeric_features_PM020O, 3.7253167629241943
numeric_features_E01756670101, 3.7193894386291504
numeric_features_GEN014, 3.700908660888672
numeric_features_E01904800101, 3.683790922164917
numeric_features_E01754660301, 3.683109760284424
categorical_features_state_Vec_AK, 3.673985719680786
numeric_features_PM000M, 3.656852960586548
numeric_features_86, 3.6494224071502686
categorical_features_state_Vec_LA, 3.639597177505493
numeric_features_E01758870101, 3.638085126876831
numeric_features_E01754850101, 3.621490716934204
categorical_features_state_Vec_MS, 3.6143782138824463
numeric_features_E01759490101, 3.6122004985809326
numeric_features_W00001260101, 3.608219861984253
numeric_features_IM010N, 3.605867862701416
numeric_features_E01755920101, 3.6046226024627686
numeric_features_E01754870101, 3.603179693222046
numeric_features_E01759000101, 3.60221004486084
numeric_features_CIR039, 3.597647190093994
numeric_features_E01754270101, 3.585326910018921
categorical_features_state_Vec_SC, 3.5811758041381836
numeric_features_EC010N, 3.5810840129852295
numeric_features_E01754630202, 3.579763412475586
numeric_features_B5, 3.5544395446777344
numeric_features_CIR037, 3.552335739135742
categorical_features_married_Vec_missing, 3.5519676208496094
numeric_features_E01754890101, 3.5461244583129883
numeric_features_E01757860101, 3.5437841415405273
numeric_features_E01754940101, 3.536203145980835
numeric_features_CIR035, 3.5354275703430176
numeric_features_E01754830101, 3.5333633422851562
numeric_features_E01755840101, 3.5191421508789062
numeric_features_72, 3.509931802749634
numeric_features_E01759280101, 3.5092666149139404
numeric_features_E01754830201, 3.5057449340820312
numeric_features_PM014M, 3.502060890197754
numeric_features_81, 3.497694730758667
numeric_features_E01759450101, 3.497203826904297
numeric_features_E01754770301, 3.4965384006500244
categorical_features_race_Vec_asian, 3.485178232192993
numeric_features_NA99N, 3.482236862182617
numeric_features_E01755660101, 3.482006072998047
numeric_features_E01756910202, 3.475698232650757
numeric_features_RD028N, 3.469539165496826
numeric_features_PC000M, 3.457275152206421
numeric_features_E01838880101, 3.456598997116089
numeric_features_CIR036, 3.4505767822265625
numeric_features_93, 3.449808359146118
numeric_features_E01754880201, 3.4438276290893555
numeric_features_E01755940401, 3.4427919387817383
numeric_features_68, 3.440281629562378
categorical_features_state_Vec_SD, 3.437988042831421
numeric_features_E01755740303, 3.4324629306793213
numeric_features_IU016N, 3.4303359985351562
numeric_features_RI018N, 3.4291458129882812
categorical_features_fedPovLine_Vec_200AndMore, 3.425727605819702
numeric_features_PM011M, 3.4192216396331787
numeric_features_DIG015, 3.4148290157318115
numeric_features_69, 3.412796974182129
numeric_features_E01754770201, 3.411539077758789
numeric_features_PO040O, 3.4051361083984375
numeric_features_PO000M, 3.404052257537842
numeric_features_OA004N, 3.398531436920166
numeric_features_B1, 3.3890795707702637
numeric_features_E01801860101, 3.3886213302612305
numeric_features_E01754280101, 3.385742664337158
numeric_features_PM020M, 3.3841826915740967
numeric_features_CIR033, 3.3804147243499756
numeric_features_RD001N, 3.371338129043579
numeric_features_E01754860101, 3.3706090450286865
numeric_features_DIG011, 3.3634276390075684
numeric_features_E01755720101, 3.360394239425659
numeric_features_CIR034, 3.3588006496429443
numeric_features_PE001M, 3.354030132293701
numeric_features_IU015N, 3.3504250049591064
numeric_features_DG004N, 3.3442647457122803
categorical_features_state_Vec_NM, 3.343963861465454
numeric_features_PG043M, 3.341928243637085
numeric_features_DIG016, 3.3411312103271484
numeric_features_NEO013, 3.3395678997039795
numeric_features_CIR032, 3.335989475250244
numeric_features_A8, 3.33465576171875
numeric_features_IC007N, 3.334568500518799
numeric_features_NEO020, 3.3322110176086426
numeric_features_76, 3.3301496505737305
categorical_features_state_Vec_ND, 3.329458236694336
numeric_features_E01754820101, 3.327533006668091
numeric_features_PG012O, 3.3186354637145996
numeric_features_E01754890201, 3.3077445030212402
numeric_features_PM041M, 3.306464433670044
numeric_features_DIG010, 3.3010730743408203
numeric_features_E01758140101, 3.2980618476867676
numeric_features_RSP009, 3.2919392585754395
numeric_features_PM011O, 3.287843942642212
numeric_features_70, 3.2843375205993652
numeric_features_E01756690101, 3.283616781234741
categorical_features_sex_Vec_male, 3.2792954444885254
categorical_features_speakEnglish_Vec_no, 3.2767441272735596
numeric_features_PM041O, 3.273555040359497
numeric_features_PH034O, 3.2734861373901367
numeric_features_E01759350201, 3.2653329372406006
numeric_features_74, 3.265324592590332
numeric_features_IC000N, 3.264470100402832
numeric_features_87, 3.26159405708313
numeric_features_RI024N, 3.2561559677124023
numeric_features_PV019M, 3.2536630630493164
categorical_features_disabled_Vec_no, 3.248345136642456
numeric_features_E01755780101, 3.245820999145508
numeric_features_E01755750101, 3.2424204349517822
numeric_features_PE000O, 3.241194725036621
numeric_features_DIG009, 3.239896059036255
numeric_features_EB009N, 3.233978271484375
numeric_features_E01758400101, 3.2294976711273193
numeric_features_PO022O, 3.225848913192749
numeric_features_79, 3.22344970703125
numeric_features_CIR030, 3.2199697494506836
numeric_features_TL000N, 3.219592809677124
numeric_features_E01755830101, 3.2130861282348633
numeric_features_IS005N, 3.2054996490478516
numeric_features_INJ038, 3.1951489448547363
numeric_features_PO027M, 3.1949055194854736
numeric_features_DIG012, 3.1841089725494385
numeric_features_PO045M, 3.1817076206207275
numeric_features_CIR031, 3.1700916290283203
numeric_features_E01754660101, 3.1614115238189697
numeric_features_INJ036, 3.1599953174591064
numeric_features_E01754810101, 3.1531834602355957
numeric_features_OA003N, 3.1503546237945557
numeric_features_INJ034, 3.147761583328247
numeric_features_SKN003, 3.140087366104126
numeric_features_TL004N, 3.1397743225097656
categorical_features_state_Vec_WV, 3.139176845550537
categorical_features_state_Vec_VT, 3.1358158588409424
numeric_features_PB000O, 3.1353302001953125
numeric_features_DIG014, 3.132481575012207
numeric_features_SYM013, 3.1302103996276855
numeric_features_CIR019, 3.1245970726013184
numeric_features_E01754820201, 3.120251417160034
numeric_features_E01755760101, 3.117732286453247
numeric_features_MBD010, 3.1144533157348633
numeric_features_E01756410101, 3.1127891540527344
numeric_features_E01755520101, 3.107306957244873
numeric_features_OB005N, 3.1034927368164062
numeric_features_PG000O, 3.1033148765563965
numeric_features_EV000N, 3.094144582748413
numeric_features_E01757220204, 3.081542491912842
numeric_features_E01838900101, 3.0755245685577393
numeric_features_EO012N, 3.074244976043701
numeric_features_E01755740201, 3.0669119358062744
numeric_features_NEO040, 3.0589263439178467
numeric_features_IS004N, 3.0484580993652344
numeric_features_B4, 3.0471088886260986
numeric_features_RX027N, 3.0447614192962646
numeric_features_PE046M, 3.0413222312927246
numeric_features_NEO008, 3.0369014739990234
numeric_features_A3, 3.035459518432617
numeric_features_EV011N, 3.029944658279419
numeric_features_84, 3.0297183990478516
numeric_features_RI025N, 3.0290844440460205
numeric_features_MBD019, 3.028125762939453
numeric_features_ER000N, 3.0278115272521973
numeric_features_DE022N, 3.0215084552764893
numeric_features_PM014O, 3.021472454071045
numeric_features_FAC009, 3.013911008834839
numeric_features_E01754870201, 3.0125958919525146
numeric_features_RX000N, 3.0020227432250977
numeric_features_OC000N, 2.9939441680908203
numeric_features_DIG001, 2.992968797683716
numeric_features_E01838960501, 2.9927141666412354
categorical_features_state_Vec_CO, 2.9882330894470215
numeric_features_MBD006, 2.988159656524658
numeric_features_PV005O, 2.9880447387695312
numeric_features_CIR029, 2.987039566040039
numeric_features_E01757220205, 2.9855003356933594
numeric_features_RSP010, 2.9818379878997803
numeric_features_E01801820101, 2.980550527572632
numeric_features_NEO010, 2.9772183895111084
numeric_features_MBD003, 2.97634220123291
numeric_features_PG004M, 2.9735891819000244
numeric_features_21, 2.9715425968170166
numeric_features_DIG013, 2.9644055366516113
numeric_features_11, 2.96364426612854
numeric_features_PC018O, 2.961822748184204
numeric_features_E01756640101, 2.9561984539031982
numeric_features_EI003N, 2.9560019969940186
numeric_features_IM009N, 2.955641269683838
numeric_features_E01755350101, 2.9547932147979736
numeric_features_DF008N, 2.9542953968048096
numeric_features_INJ015, 2.9522483348846436
numeric_features_MAL009, 2.9509899616241455
numeric_features_IS000N, 2.9504213333129883
numeric_features_INJ065, 2.945216178894043
numeric_features_NEO011, 2.9415111541748047
numeric_features_A5, 2.937528610229492
numeric_features_27, 2.9374186992645264
numeric_features_E01758380101, 2.934032440185547
numeric_features_E01755700101, 2.9268863201141357
categorical_features_ssdi_Vec_yes, 2.926539182662964
numeric_features_E01908540101, 2.9249794483184814
numeric_features_MBD022, 2.9249095916748047
numeric_features_E01783690101, 2.9213035106658936
numeric_features_FAC019, 2.921165704727173
numeric_features_NEO014, 2.9089999198913574
numeric_features_EXT027, 2.903496265411377
numeric_features_EYE006, 2.8934600353240967
numeric_features_INJ072, 2.8902289867401123
numeric_features_CIR027, 2.880953788757324
categorical_features_ssi_Vec_missing, 2.8774991035461426
numeric_features_PG047O, 2.8738036155700684
numeric_features_PV029M, 2.8717033863067627
numeric_features_IC021N, 2.8686249256134033
numeric_features_73, 2.8604648113250732
numeric_features_E01755390101, 2.8568923473358154
numeric_features_IM023N, 2.8534650802612305
numeric_features_E01755640101, 2.852937698364258
numeric_features_INJ019, 2.8514997959136963
numeric_features_PG006M, 2.849893808364868
numeric_features_FAC006, 2.848775863647461
numeric_features_IC003N, 2.844896078109741
numeric_features_E01755650203, 2.837921380996704
numeric_features_INF003, 2.8269355297088623
numeric_features_E01758430101, 2.8232133388519287
numeric_features_E01754760101, 2.823194742202759
numeric_features_PM039O, 2.822665214538574
numeric_features_57, 2.821575880050659
numeric_features_CIR016, 2.8202667236328125
numeric_features_DEN001, 2.8184502124786377
numeric_features_OB006N, 2.814424753189087
numeric_features_DF011N, 2.807326316833496
numeric_features_EN008N, 2.8056819438934326
numeric_features_DG000N, 2.8049938678741455
numeric_features_CIR028, 2.8019461631774902
numeric_features_EV013N, 2.7947840690612793
numeric_features_INF011, 2.7929446697235107
numeric_features_INJ031, 2.79154372215271
numeric_features_SKN002, 2.791224241256714
numeric_features_DIG007, 2.788266181945801
numeric_features_E01784800201, 2.782925605773926
numeric_features_PG043O, 2.7775917053222656
numeric_features_B3, 2.773451328277588
numeric_features_PRG004, 2.7731590270996094
categorical_features_state_Vec_WA, 2.7698934078216553
numeric_features_E01758180201, 2.7673797607421875
categorical_features_state_Vec_IL, 2.759871482849121
numeric_features_OA002N, 2.7584571838378906
numeric_features_E01755610203, 2.758219003677368
numeric_features_INJ060, 2.7563982009887695
numeric_features_EH018N, 2.7539703845977783
numeric_features_EI005N, 2.7506394386291504
numeric_features_DF019N, 2.7497994899749756
numeric_features_DA018N, 2.7437744140625
categorical_features_ssi_Vec_no, 2.742204427719116
numeric_features_CIR018, 2.739919424057007
numeric_features_E01757200101, 2.7379720211029053
numeric_features_E01755620201, 2.7364425659179688
numeric_features_E01839070301, 2.7348129749298096
numeric_features_E01756800101, 2.72943377494812
numeric_features_DA000N, 2.728344440460205
numeric_features_DE015N, 2.715179443359375
numeric_features_TC010N, 2.710393190383911
numeric_features_PG004O, 2.707365036010742
categorical_features_race_Vec_black, 2.706937313079834
numeric_features_E01755260101, 2.7024433612823486
numeric_features_SKN006, 2.7023024559020996
numeric_features_RSP016, 2.700592279434204
numeric_features_INJ035, 2.700300455093384
numeric_features_OA001N, 2.695176124572754
numeric_features_INJ013, 2.6940910816192627
numeric_features_NEO052, 2.691073179244995
numeric_features_INJ012, 2.690133571624756
numeric_features_INJ052, 2.6817626953125
numeric_features_FAC005, 2.680447578430176
numeric_features_INJ039, 2.6792991161346436
numeric_features_NEO056, 2.6774346828460693
numeric_features_DIG006, 2.676445960998535
numeric_features_ER002N, 2.675659418106079
numeric_features_CIR022, 2.673752546310425
numeric_features_NEO037, 2.6733667850494385
numeric_features_NEO065, 2.672940254211426
numeric_features_DF010N, 2.668942928314209
numeric_features_INJ027, 2.6665613651275635
numeric_features_PM024O, 2.6663684844970703
numeric_features_36, 2.666051149368286
numeric_features_FAC014, 2.6634974479675293
numeric_features_INJ040, 2.660982608795166
categorical_features_houseSize_Vec_single, 2.6562283039093018
numeric_features_E01758360101, 2.653717517852783
numeric_features_FAC008, 2.653590202331543
numeric_features_E01757940101, 2.6529016494750977
numeric_features_FAC010, 2.650834083557129
numeric_features_NEO019, 2.6505379676818848
numeric_features_INF006, 2.645493984222412
numeric_features_E01758000101, 2.6451797485351562
numeric_features_IN002N, 2.642977714538574
numeric_features_PM007O, 2.6378207206726074
numeric_features_IS024N, 2.629218816757202
numeric_features_FAC016, 2.6248137950897217
numeric_features_IC006N, 2.622631311416626
numeric_features_PS013M, 2.62054443359375
numeric_features_E01756130101, 2.6183505058288574
numeric_features_INF009, 2.6173079013824463
numeric_features_E01756940101, 2.617145538330078
numeric_features_E01755000101, 2.615100860595703
numeric_features_E01754890202, 2.6128950119018555
numeric_features_61, 2.6115989685058594
numeric_features_E01841670101, 2.606867551803589
numeric_features_PE001O, 2.605976104736328
numeric_features_W00000070101, 2.6016845703125
numeric_features_E01759090701, 2.5974347591400146
numeric_features_PG000M, 2.5970799922943115
numeric_features_INJ066, 2.595717191696167
numeric_features_E01759080101, 2.595673084259033
categorical_features_state_Vec_CA, 2.594665050506592
numeric_features_MAL003, 2.5939698219299316
numeric_features_TF015N, 2.59258770942688
numeric_features_MUS019, 2.591214895248413
numeric_features_E01756910101, 2.5864968299865723
numeric_features_E01783720101, 2.5852277278900146
numeric_features_TF000N, 2.5781681537628174
numeric_features_E01754340101, 2.5776143074035645
numeric_features_NEO039, 2.574425458908081
numeric_features_DG006N, 2.5729119777679443
numeric_features_E01757400101, 2.571208953857422
numeric_features_EM019N, 2.5685312747955322
numeric_features_MAL004, 2.5664684772491455
numeric_features_E01754700101, 2.566211223602295
numeric_features_INJ054, 2.5652713775634766
numeric_features_INJ025, 2.564389705657959
numeric_features_E01867750101, 2.5642471313476562
numeric_features_B2, 2.5631914138793945
numeric_features_FAC015, 2.5602915287017822
numeric_features_E01755650202, 2.5599045753479004
numeric_features_E01755640201, 2.5545685291290283
numeric_features_NEO007, 2.55401873588562
numeric_features_E01758100101, 2.550523042678833
numeric_features_INJ061, 2.5473110675811768
numeric_features_INJ006, 2.5472302436828613
numeric_features_MUS034, 2.5459885597229004
numeric_features_MBD004, 2.5441784858703613
numeric_features_GEN025, 2.543792724609375
numeric_features_E01754190101, 2.543776750564575
numeric_features_FAC017, 2.543609619140625
numeric_features_RSP007, 2.543464183807373
numeric_features_E01757620101, 2.542961597442627
numeric_features_MBD025, 2.5425195693969727
numeric_features_INJ004, 2.5416886806488037
numeric_features_80, 2.5401782989501953
numeric_features_NEO055, 2.535444736480713
numeric_features_E01755760204, 2.531780242919922
numeric_features_NEO057, 2.5305120944976807
numeric_features_CIR013, 2.5287485122680664
numeric_features_NEO009, 2.528608798980713
numeric_features_NEO041, 2.5274226665496826
numeric_features_FAC020, 2.5260486602783203
numeric_features_FAC012, 2.5246214866638184
numeric_features_MAL007, 2.5222320556640625
numeric_features_IX017N, 2.521906614303589
numeric_features_NEO004, 2.5196592807769775
numeric_features_NEO029, 2.5189576148986816
categorical_features_race_Vec_multiracial, 2.518082857131958
numeric_features_DIG021, 2.516284942626953
numeric_features_Z2, 2.512638568878174
numeric_features_MUS011, 2.508551597595215
numeric_features_SYM006, 2.5033340454101562
numeric_features_EV004N, 2.501650810241699
numeric_features_E01757790101, 2.5013811588287354
numeric_features_INJ007, 2.501183032989502
numeric_features_EXT028, 2.4963290691375732
categorical_features_state_Vec_DE, 2.4955646991729736
numeric_features_E01754130101, 2.4949710369110107
numeric_features_NEO032, 2.4949417114257812
numeric_features_E01758750101, 2.4942967891693115
numeric_features_IN000N, 2.493234157562256
numeric_features_EN016N, 2.4915432929992676
numeric_features_E01758360201, 2.490765333175659
numeric_features_EXT026, 2.490088701248169
numeric_features_EB000N, 2.4882113933563232
numeric_features_E01758540101, 2.487416982650757
numeric_features_MUS004, 2.48520565032959
numeric_features_PRG017, 2.4822731018066406
numeric_features_MUS037, 2.4810876846313477
numeric_features_DIG018, 2.4810445308685303
numeric_features_RT020N, 2.480316162109375
numeric_features_DF000N, 2.477976083755493
numeric_features_E01904850101, 2.473973035812378
numeric_features_GEN021, 2.471723794937134
numeric_features_DIG008, 2.471613645553589
numeric_features_INJ076, 2.4707229137420654
numeric_features_PV049M, 2.465336561203003
numeric_features_GEN017, 2.4648079872131348
numeric_features_MAL010, 2.461679458618164
numeric_features_MUS032, 2.4615402221679688
numeric_features_INJ009, 2.461346387863159
numeric_features_DIG020, 2.457916259765625
numeric_features_E01754630101, 2.4573354721069336
numeric_features_EX000N, 2.457156181335449
numeric_features_MBD005, 2.4538280963897705
numeric_features_END011, 2.4534997940063477
numeric_features_NEO042, 2.4533884525299072
numeric_features_SKN001, 2.4528746604919434
numeric_features_MBD023, 2.4527246952056885
numeric_features_E01821590101, 2.4493486881256104
numeric_features_EV001N, 2.4485511779785156
numeric_features_PRG003, 2.4458248615264893
numeric_features_TA002N, 2.4435691833496094
numeric_features_E01757000201, 2.440927743911743
numeric_features_INJ001, 2.440418243408203
categorical_features_state_Vec_NV, 2.4391887187957764
numeric_features_DIG004, 2.437946081161499
numeric_features_EXT029, 2.4370758533477783
numeric_features_PM015O, 2.4363901615142822
numeric_features_NEO003, 2.4360148906707764
numeric_features_INJ049, 2.4344029426574707
numeric_features_E01759440101, 2.4339599609375
numeric_features_E01754140101, 2.4280083179473877
numeric_features_PB033M, 2.4263827800750732
numeric_features_PRG029, 2.4235997200012207
numeric_features_SYM002, 2.4195313453674316
numeric_features_E01758350101, 2.418670654296875
numeric_features_MBD026, 2.418409585952759
numeric_features_INJ048, 2.4095847606658936
numeric_features_TC000N, 2.4092700481414795
numeric_features_NEO066, 2.4066848754882812
numeric_features_INJ026, 2.402320146560669
numeric_features_SYM016, 2.40093994140625
numeric_features_NEO053, 2.4008543491363525
numeric_features_INJ003, 2.4004428386688232
numeric_features_E01756560101, 2.3997509479522705
numeric_features_FAC023, 2.3997480869293213
numeric_features_GEN006, 2.399221420288086
numeric_features_saServRate, 2.3938701152801514
numeric_features_E01756820302, 2.3928909301757812
numeric_features_62, 2.391613483428955
numeric_features_INJ047, 2.3895926475524902
numeric_features_INJ028, 2.3865573406219482
numeric_features_NEO017, 2.3843493461608887
numeric_features_SYM004, 2.384296417236328
numeric_features_GEN007, 2.3835694789886475
numeric_features_INJ073, 2.3832738399505615
numeric_features_E01756590101, 2.3822743892669678
numeric_features_FAC022, 2.381141185760498
numeric_features_14, 2.3734092712402344
numeric_features_MUS009, 2.372499942779541
numeric_features_E01758010101, 2.3683738708496094
numeric_features_MUS016, 2.366468906402588
numeric_features_INJ053, 2.366453170776367
numeric_features_INJ075, 2.3650379180908203
numeric_features_DIG005, 2.3643240928649902
numeric_features_NEO018, 2.3617632389068604
categorical_features_state_Vec_VA, 2.361185073852539
numeric_features_EYE012, 2.3607523441314697
numeric_features_INJ042, 2.3597352504730225
numeric_features_NEO063, 2.358217239379883
numeric_features_PH000O, 2.356964111328125
numeric_features_INJ056, 2.356722593307495
numeric_features_CIR007, 2.3560938835144043
numeric_features_CIR025, 2.353137731552124
numeric_features_PM021M, 2.3504974842071533
numeric_features_RR009N, 2.349963426589966
numeric_features_E01783780101, 2.3488402366638184
numeric_features_NEO051, 2.3484342098236084
numeric_features_E01758250101, 2.346982479095459
numeric_features_GEN019, 2.340045928955078
numeric_features_PB052O, 2.337858200073242
numeric_features_GEN010, 2.33510160446167
numeric_features_END013, 2.333284616470337
numeric_features_RSP008, 2.331493377685547
numeric_features_EYE002, 2.331063985824585
numeric_features_DIG022, 2.3309295177459717
numeric_features_E01754190201, 2.327129364013672
numeric_features_IU014N, 2.3265533447265625
numeric_features_E01755610301, 2.3265187740325928
numeric_features_E01755800101, 2.326181650161743
numeric_features_25, 2.32421875
numeric_features_CIR003, 2.3145828247070312
numeric_features_MAL001, 2.314211368560791
numeric_features_NEO030, 2.312248706817627
numeric_features_all_cause_ip, 2.3118607997894287
numeric_features_NEO001, 2.310833215713501
numeric_features_MBD001, 2.310286045074463
numeric_features_MUS038, 2.3063602447509766
numeric_features_E01757390301, 2.3055331707000732
numeric_features_E01783740101, 2.3052377700805664
numeric_features_RSP006, 2.304326295852661
categorical_features_houseSize_Vec_sixorMore, 2.302974224090576
numeric_features_INF004, 2.2977442741394043
numeric_features_EXT007, 2.297060012817383
numeric_features_45, 2.2947998046875
numeric_features_MUS022, 2.293264627456665
numeric_features_E01758420101, 2.2914206981658936
numeric_features_INF005, 2.290208339691162
numeric_features_PRG028, 2.2863800525665283
numeric_features_E01759020101, 2.2841453552246094
numeric_features_13, 2.283806324005127
numeric_features_INJ041, 2.2819647789001465
numeric_features_EYE004, 2.279956340789795
numeric_features_FAC021, 2.2764620780944824
numeric_features_INF008, 2.27177357673645
numeric_features_EAR005, 2.267850637435913
numeric_features_MUS002, 2.267162322998047
numeric_features_GEN002, 2.2660281658172607
numeric_features_PC031M, 2.263638496398926
numeric_features_E01861050101, 2.26173734664917
numeric_features_INJ044, 2.2591137886047363
numeric_features_CIR023, 2.2576088905334473
numeric_features_SKN007, 2.2557740211486816
numeric_features_END007, 2.247215986251831
numeric_features_IX000N, 2.244617462158203
numeric_features_E01755630101, 2.234476327896118
numeric_features_E01757650101, 2.2322869300842285
numeric_features_CIR020, 2.229282855987549
numeric_features_E01756040101, 2.228867769241333
numeric_features_INJ037, 2.2283270359039307
numeric_features_NEO034, 2.22389554977417
numeric_features_E01759110101, 2.223588705062866
numeric_features_IN008N, 2.2230052947998047
numeric_features_E01759800201, 2.219902515411377
numeric_features_DIG025, 2.218552350997925
numeric_features_E01755430101, 2.218536376953125
numeric_features_GEN015, 2.2166104316711426
numeric_features_RSP017, 2.2145910263061523
numeric_features_EYE003, 2.2118403911590576
numeric_features_EXT013, 2.210947275161743
numeric_features_GEN020, 2.2100002765655518
numeric_features_E01912810101, 2.206087112426758
numeric_features_NEO061, 2.2026093006134033
numeric_features_END016, 2.2022414207458496
numeric_features_INJ014, 2.2014546394348145
numeric_features_INF007, 2.201260566711426
numeric_features_RSP011, 2.201064109802246
numeric_features_E01755620101, 2.2005248069763184
numeric_features_CIR024, 2.199293375015259
numeric_features_NEO012, 2.1989238262176514
numeric_features_PRG014, 2.198575019836426
numeric_features_FAC018, 2.1963682174682617
numeric_features_INJ024, 2.191150188446045
numeric_features_E01910010301, 2.19085693359375
numeric_features_97, 2.1878910064697266
numeric_features_INJ021, 2.184152126312256
numeric_features_EH000N, 2.181919574737549
categorical_features_UsCitizen_Vec_missing, 2.1815719604492188
numeric_features_NEO002, 2.1812989711761475
numeric_features_FAC004, 2.176614284515381
numeric_features_EYE001, 2.176483154296875
numeric_features_22, 2.1762337684631348
numeric_features_78, 2.175018310546875
numeric_features_MUS028, 2.1708526611328125
numeric_features_CIR009, 2.1696341037750244
numeric_features_TA000N, 2.1688060760498047
numeric_features_MBD007, 2.1678566932678223
numeric_features_MUS023, 2.16648006439209
numeric_features_GEN001, 2.164241313934326
numeric_features_INF010, 2.1600592136383057
numeric_features_MUS003, 2.157182455062866
numeric_features_E01758390101, 2.155010461807251
numeric_features_E01839000201, 2.1545569896698
numeric_features_RSP013, 2.150747060775757
categorical_features_houseSize_Vec_missing, 2.1498184204101562
numeric_features_E01759340101, 2.1478843688964844
numeric_features_INJ005, 2.145134210586548
numeric_features_CIR008, 2.143641233444214
numeric_features_EXT012, 2.141575813293457
numeric_features_PC003M, 2.1396868228912354
numeric_features_BLD007, 2.139604330062866
numeric_features_EXT015, 2.138824462890625
numeric_features_PG047M, 2.137942314147949
numeric_features_E01755910101, 2.1376967430114746
numeric_features_BLD010, 2.137253999710083
numeric_features_65, 2.1359615325927734
numeric_features_EYE009, 2.1357338428497314
numeric_features_DD000N, 2.1356420516967773
numeric_features_CIR006, 2.1336848735809326
numeric_features_PC018M, 2.130735397338867
numeric_features_NEO028, 2.1306214332580566
numeric_features_E01755650401, 2.1300647258758545
numeric_features_A2, 2.12930965423584
numeric_features_FAC011, 2.1256556510925293
numeric_features_BLD005, 2.1239147186279297
numeric_features_E01758770101, 2.123046875
numeric_features_CIR001, 2.1227707862854004
numeric_features_MAL008, 2.1225156784057617
numeric_features_E01754610101, 2.1219775676727295
numeric_features_E01755900101, 2.12162446975708
numeric_features_E01755940501, 2.1199586391448975
numeric_features_E01755070101, 2.1189422607421875
numeric_features_PM039M, 2.118614435195923
numeric_features_CIR002, 2.118454933166504
numeric_features_END003, 2.1172003746032715
numeric_features_END001, 2.116284132003784
numeric_features_E01755630201, 2.1149487495422363
numeric_features_SYM001, 2.1149253845214844
numeric_features_E01757710101, 2.111903667449951
numeric_features_MUS030, 2.1096889972686768
numeric_features_CIR021, 2.1055691242218018
numeric_features_INJ062, 2.102081298828125
numeric_features_DIG023, 2.1013944149017334
numeric_features_E01758890101, 2.0987396240234375
numeric_features_INJ069, 2.0975751876831055
numeric_features_MUS005, 2.097484588623047
numeric_features_INJ030, 2.09596848487854
numeric_features_EYE007, 2.0951876640319824
numeric_features_non_avoid_ip, 2.0937390327453613
numeric_features_all_cause_ed, 2.090665817260742
numeric_features_SYM014, 2.0892419815063477
numeric_features_NEO024, 2.0881128311157227
categorical_features_fedPovLine_Vec_100To200, 2.087979316711426
numeric_features_NEO060, 2.087310791015625
numeric_features_EYE005, 2.0840213298797607
numeric_features_CIR004, 2.083249568939209
numeric_features_RSP015, 2.0826854705810547
numeric_features_EXT014, 2.0768325328826904
numeric_features_MAL005, 2.076653242111206
numeric_features_CIR005, 2.0757994651794434
numeric_features_CIR010, 2.0748391151428223
numeric_features_CIR017, 2.0726850032806396
numeric_features_EE000N, 2.071443557739258
numeric_features_E01755890101, 2.0710668563842773
numeric_features_MUS012, 2.069354295730591
numeric_features_INJ058, 2.069272756576538
numeric_features_EYE010, 2.0678329467773438
numeric_features_CIR015, 2.063769817352295
numeric_features_END015, 2.0634782314300537
numeric_features_GEN018, 2.0620903968811035
numeric_features_98, 2.0614099502563477
numeric_features_NEO006, 2.0602381229400635
numeric_features_ccsr_null, 2.0579731464385986
numeric_features_EXT002, 2.0567212104797363
numeric_features_CIR012, 2.0565388202667236
numeric_features_BLD008, 2.056365489959717
numeric_features_CIR014, 2.056013822555542
numeric_features_urgentCareRate, 2.051514148712158
numeric_features_EXT006, 2.0512466430664062
numeric_features_PC008O, 2.047760009765625
numeric_features_MAL002, 2.044116497039795
numeric_features_MBD009, 2.0426857471466064
numeric_features_E01755760201, 2.041520595550537
numeric_features_E01757050101, 2.040956497192383
numeric_features_NEO005, 2.040613889694214
numeric_features_NEO015, 2.0383083820343018
numeric_features_RR000N, 2.0374794006347656
numeric_features_E01755730101, 2.0371627807617188
numeric_features_DIG019, 2.036432981491089
numeric_features_NEO044, 2.0313072204589844
numeric_features_NEO023, 2.031007766723633
numeric_features_DIG024, 2.030583620071411
numeric_features_INJ033, 2.026815891265869
numeric_features_EE007N, 2.021881103515625
numeric_features_INJ008, 2.0192437171936035
numeric_features_MBD002, 2.0187740325927734
numeric_features_INJ067, 2.0097079277038574
numeric_features_MUS025, 2.0093512535095215
numeric_features_E01818110101, 2.0070581436157227
categorical_features_ssi_Vec_yes, 2.006399393081665
numeric_features_BLD004, 2.005248546600342
numeric_features_E01923390101, 2.0036091804504395
numeric_features_FAC002, 1.9981635808944702
numeric_features_MUS036, 1.993934988975525
numeric_features_MBD018, 1.9889246225357056
numeric_features_INF002, 1.9840834140777588
numeric_features_RX034N, 1.9829965829849243
numeric_features_all_cause_acute, 1.980324149131775
numeric_features_EAR003, 1.9800059795379639
numeric_features_INJ050, 1.9799089431762695
numeric_features_NEO016, 1.97895348072052
categorical_features_sex_Vec_female, 1.9777774810791016
numeric_features_BLD001, 1.9772578477859497
numeric_features_E01755570201, 1.9748866558074951
numeric_features_EXT008, 1.9712759256362915
numeric_features_04, 1.9696191549301147
numeric_features_PG026M, 1.966440200805664
numeric_features_E01758230101, 1.9658523797988892
numeric_features_BLD009, 1.965658187866211
numeric_features_49, 1.9651985168457031
numeric_features_INJ064, 1.958953619003296
numeric_features_NEO050, 1.9569854736328125
numeric_features_E01914930101, 1.953360915184021
numeric_features_BLD006, 1.9513089656829834
numeric_features_INJ043, 1.9446334838867188
numeric_features_NEO021, 1.9445899724960327
numeric_features_NEO025, 1.9395999908447266
numeric_features_FAC024, 1.9378331899642944
numeric_features_NEO043, 1.9329419136047363
numeric_features_BLD002, 1.9233227968215942
numeric_features_INJ070, 1.9219474792480469
numeric_features_percent_med_adherence, 1.9212223291397095
numeric_features_INJ011, 1.9208781719207764
numeric_features_A1, 1.9203643798828125
numeric_features_NEO047, 1.911376953125
numeric_features_END014, 1.9111404418945312
numeric_features_INJ063, 1.908231258392334
numeric_features_GEN008, 1.902155876159668
numeric_features_publicAssistRate, 1.9013686180114746
numeric_features_MBD008, 1.8958969116210938
numeric_features_EAR006, 1.885589599609375
numeric_features_INJ032, 1.8755890130996704
numeric_features_MUS031, 1.8662490844726562
numeric_features_FAC007, 1.8635873794555664
numeric_features_SYM005, 1.8622617721557617
numeric_features_BLD003, 1.8613595962524414
numeric_features_EXT019, 1.8606345653533936
numeric_features_NEO046, 1.859677791595459
numeric_features_E01756790101, 1.8575907945632935
numeric_features_SYM008, 1.8536968231201172
numeric_features_pharm_slope, 1.834700107574463
numeric_features_EAR002, 1.8255805969238281
categorical_features_state_Vec_AR, 1.8244880437850952
numeric_features_EXT030, 1.8178415298461914
numeric_features_NEO022, 1.8104686737060547
numeric_features_CIR011, 1.8073978424072266
numeric_features_PV030M, 1.7937654256820679
numeric_features_aprnRate, 1.7746492624282837
numeric_features_E01756930101, 1.7726566791534424
numeric_features_GEN022, 1.7715232372283936
numeric_features_avoid_slope, 1.7709473371505737
numeric_features_RSP012, 1.7657184600830078
numeric_features_drugdeathRate, 1.758943796157837
numeric_features_PM024M, 1.758056640625
numeric_features_number_of_fills, 1.7496025562286377
numeric_features_allcause_slope, 1.747484564781189
numeric_features_INJ010, 1.7457542419433594
numeric_features_povRate, 1.7361623048782349
numeric_features_goodAirDays, 1.7304110527038574
numeric_features_avoid_ip, 1.7267221212387085
categorical_features_state_Vec_WI, 1.726552963256836
numeric_features_avoid_ed, 1.7235265970230103
numeric_features_100HeatDays, 1.7123785018920898
numeric_features_NVS012, 1.7111148834228516
numeric_features_MBD012, 1.6942501068115234
numeric_features_injDeathRate, 1.693150281906128
numeric_features_NEO036, 1.686450481414795
numeric_features_07, 1.6780261993408203
numeric_features_E01755650101, 1.6688892841339111
numeric_features_NEO054, 1.6686135530471802
numeric_features_INJ029, 1.6668124198913574
numeric_features_MBD020, 1.665561318397522
numeric_features_MUS015, 1.6591825485229492
numeric_features_popDensity, 1.6363941431045532
numeric_features_FAC003, 1.634209156036377
numeric_features_avoid_acute, 1.6175662279129028
numeric_features_saFacRate, 1.6139122247695923
numeric_features_E01755620203, 1.5974817276000977
numeric_features_highSchoolGradRate, 1.597090244293213
numeric_features_PS038O, 1.5642118453979492
numeric_features_INJ057, 1.5491502285003662
numeric_features_number_of_unique_med, 1.5359022617340088
numeric_features_percent_generic, 1.5358818769454956
numeric_features_NEO035, 1.5349292755126953
numeric_features_age, 1.4971951246261597
numeric_features_INJ071, 1.4940857887268066
numeric_features_non_avoid_ed, 1.4916528463363647
numeric_features_mhTreatRate, 1.4848604202270508
numeric_features_EXT003, 1.4561302661895752
numeric_features_SYM011, 1.4015240669250488
numeric_features_E01754530101, 1.36397385597229
numeric_features_MUS006, 1.3344855308532715
numeric_features_E01914210101, 1.3162660598754883
numeric_features_INJ059, 1.2434062957763672
numeric_features_PRG020, 1.1976861953735352
numeric_features_MAL006, 1.1840134859085083

"""

#input_data = [f'"{x.strip()}"' for x in input_data.strip().split('\n') if x.strip()]
input_data = [x.strip() for x in input_data.strip().split('\n') if x.strip()]
print(input_data)

# COMMAND ----------

matches1 = [x for x in input_data if x.split(', ')[0] not in comparison]

def safe_sort_key(x):
    parts = x.split(', ')
    if len(parts) > 1:
        try:
            return float(parts[1])
        except ValueError:
            return float('-inf')  # or another appropriate default value
    else:
        return float('-inf')  # or another appropriate default value

matches1.sort(key=safe_sort_key, reverse=True)

matches1 = matches1[:30]

for match in matches1:
    feature, value = match.split(', ')
    print(f"{feature}, {float(value):.2f}")

# COMMAND ----------

# create a DataFrame from the matches1 list
from pyspark.sql.types import StructType, StructField, StringType, IntegerType
from pyspark.sql.types import FloatType
from pyspark.sql.functions import round

# define the schema
schema = StructType([
    StructField("feature", StringType(), True),
    StructField("raw_value", FloatType(), True)
])

df = spark.createDataFrame([(x.split(", ")[0], float(x.split(", ")[1])) for x in matches1], schema)
df.show()

# COMMAND ----------

def is_float(s):
    try:
        float(s)
        return True
    except ValueError:
        return False

max_value = max(float(x.split(', ')[1]) for x in input_data if len(x.split(', ')) > 1 and is_float(x.split(', ')[1]))
print(max_value)

# COMMAND ----------

df = df.withColumn("scaled_value", df["raw_value"] / max_value)
df = df.withColumn("raw_value", round(df["raw_value"], 2)).withColumn("scaled_value", round(df["scaled_value"], 2))
df.show(truncate=False)

# COMMAND ----------

from pyspark.sql.functions import col

# Filter the DataFrame
df = df.filter(col('feature').startswith('numeric_features'))

# Show the resulting DataFrame
df.show(truncate=False, n=30)

# COMMAND ----------

print(df.count())

# COMMAND ----------

df.write.saveAsTable("dua_058828_spa240.paper_4_wcv_non_sdoh_feature_imp", mode="overwrite")


# COMMAND ----------

