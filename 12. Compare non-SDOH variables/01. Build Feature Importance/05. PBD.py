# Databricks notebook source
comparison = [
    'numeric_features_saServRate', 'numeric_features_saFacRate', 'numeric_features_mhTreatRate', 'numeric_features_popDensity', 'numeric_features_povRate', 'numeric_features_publicAssistRate', 'numeric_features_highSchoolGradRate', 'numeric_features_goodAirDays', 'numeric_features_injDeathRate', 'numeric_features_urgentCareRate', 'numeric_features_drugdeathRate', 'numeric_features_100HeatDays', 'numeric_features_aprnRate','categorical_features_race_Vec_asian', 'categorical_features_race_Vec_native', 'categorical_features_race_Vec_hawaiian', 'categorical_features_race_Vec_multiracial', 'categorical_features_houseSize_Vec_missing', 'categorical_features_houseSize_Vec_single', 'categorical_features_houseSize_Vec_twoToFive', 'categorical_features_houseSize_Vec_sixorMore', 'categorical_features_fedPovLine_Vec_missing', 'categorical_features_fedPovLine_Vec_0To100', 'categorical_features_fedPovLine_Vec_100To200', 'categorical_features_fedPovLine_Vec_200AndMore', 'categorical_features_speakEnglish_Vec_missing', 'categorical_features_speakEnglish_Vec_yes', 'categorical_features_speakEnglish_Vec_no', 'categorical_features_married_Vec_missing', 'categorical_features_married_Vec_no', 'categorical_features_married_Vec_yes', 'categorical_features_UsCitizen_Vec_yes', 'categorical_features_UsCitizen_Vec_missing', 'categorical_features_UsCitizen_Vec_no', 'categorical_features_ssi_Vec_no', 'categorical_features_ssi_Vec_missing', 'categorical_features_ssi_Vec_yes', 'categorical_features_ssdi_Vec_no', 'categorical_features_ssdi_Vec_missing', 'categorical_features_ssdi_Vec_yes', 'categorical_features_tanf_Vec_no', 'categorical_features_tanf_Vec_missing', 'categorical_features_tanf_Vec_yes', 'categorical_features_disabled_Vec_no', 'categorical_features_disabled_Vec_yes'
]

# COMMAND ----------

input_data = """

numeric_features_E01756940101, 7.18809175491333
numeric_features_E01755940401, 6.067424774169922
numeric_features_DE015N, 5.8811492919921875
numeric_features_E01754620101, 5.5660400390625
numeric_features_B3, 5.460543155670166
numeric_features_DIG012, 5.181305885314941
numeric_features_E01756040101, 4.810319423675537
numeric_features_B5, 4.72767448425293
numeric_features_DA018N, 4.62750244140625
numeric_features_MAL003, 4.619309425354004
numeric_features_IM022N, 4.609123229980469
numeric_features_NEO022, 4.602175712585449
categorical_features_state_Vec_WV, 4.5984907150268555
numeric_features_E01755750101, 4.556824684143066
numeric_features_NEO015, 4.552085876464844
numeric_features_PV029M, 4.520674228668213
numeric_features_EV013N, 4.50270414352417
numeric_features_69, 4.472922325134277
numeric_features_ER002N, 4.466551780700684
numeric_features_INJ038, 4.460915565490723
numeric_features_INJ074, 4.433670997619629
numeric_features_GEN022, 4.392995834350586
numeric_features_E01754840101, 4.385223388671875
numeric_features_RD000N, 4.370368957519531
numeric_features_E01755070101, 4.358179092407227
numeric_features_E01867750101, 4.338386535644531
numeric_features_E01758790101, 4.3293986320495605
numeric_features_E01756940201, 4.319669723510742
numeric_features_DIG013, 4.287508010864258
numeric_features_NEO018, 4.264811992645264
numeric_features_E01754140101, 4.250673770904541
numeric_features_rx_null, 4.222177982330322
numeric_features_E01755730101, 4.218891143798828
numeric_features_RT020N, 4.216833114624023
numeric_features_PC002O, 4.200389862060547
numeric_features_RSP008, 4.1816325187683105
numeric_features_INJ059, 4.174186706542969
numeric_features_NEO046, 4.155573844909668
numeric_features_INJ032, 4.148029327392578
numeric_features_END008, 4.092626094818115
numeric_features_MBD002, 4.092141628265381
numeric_features_MBD025, 4.040512561798096
numeric_features_NEO052, 4.037795543670654
numeric_features_NEO053, 4.0252227783203125
numeric_features_RSP009, 4.0182719230651855
numeric_features_EYE006, 3.9599380493164062
numeric_features_DIG014, 3.9572486877441406
categorical_features_state_Vec_WA, 3.9301114082336426
numeric_features_PG026M, 3.9300479888916016
numeric_features_RSP017, 3.9190189838409424
numeric_features_EAR002, 3.905641555786133
numeric_features_NEO019, 3.8832855224609375
numeric_features_E01759510401, 3.8375511169433594
numeric_features_INJ071, 3.8370823860168457
categorical_features_state_Vec_AK, 3.8318607807159424
categorical_features_state_Vec_IL, 3.8234355449676514
numeric_features_EXT009, 3.8211863040924072
numeric_features_DIG025, 3.8195056915283203
numeric_features_EXT026, 3.8190536499023438
numeric_features_27, 3.810795783996582
numeric_features_IM023N, 3.8082005977630615
numeric_features_84, 3.7956631183624268
numeric_features_DIG016, 3.775625705718994
numeric_features_E01754760101, 3.7543346881866455
numeric_features_IS019N, 3.7441916465759277
numeric_features_GEN018, 3.7221598625183105
numeric_features_EO012N, 3.716348648071289
numeric_features_RI023N, 3.7143478393554688
numeric_features_E01758390101, 3.7080371379852295
numeric_features_E01757220205, 3.6918118000030518
numeric_features_NEO056, 3.683406352996826
numeric_features_PE000M, 3.675830364227295
numeric_features_NEO030, 3.6749775409698486
numeric_features_RR009N, 3.6696345806121826
numeric_features_82, 3.667948007583618
numeric_features_E01828300101, 3.6668701171875
numeric_features_E01829610101, 3.660090208053589
numeric_features_MBD007, 3.6533684730529785
categorical_features_race_Vec_black, 3.6192164421081543
numeric_features_E01754610101, 3.6155905723571777
numeric_features_GEN006, 3.605712890625
numeric_features_MBD017, 3.601003885269165
numeric_features_EM019N, 3.5990593433380127
categorical_features_race_Vec_multiracial, 3.596930980682373
numeric_features_E01755210101, 3.5901379585266113
numeric_features_GEN002, 3.5860543251037598
numeric_features_INJ013, 3.5809879302978516
numeric_features_E01908520101, 3.5787978172302246
numeric_features_TF015N, 3.5770606994628906
numeric_features_PS032O, 3.575592041015625
numeric_features_E01758750101, 3.572852373123169
numeric_features_EI000N, 3.5723938941955566
numeric_features_E01779100101, 3.5701823234558105
numeric_features_NEO011, 3.56402325630188
numeric_features_RX029N, 3.56231427192688
numeric_features_SKN002, 3.5601251125335693
numeric_features_E01756230101, 3.559420585632324
numeric_features_EXT010, 3.558159828186035
numeric_features_EXT028, 3.5555694103240967
numeric_features_EN016N, 3.5528452396392822
numeric_features_NEO025, 3.5507233142852783
categorical_features_state_Vec_SD, 3.5500621795654297
numeric_features_INJ069, 3.549950361251831
numeric_features_E01755760101, 3.547715425491333
numeric_features_74, 3.543328046798706
numeric_features_INJ044, 3.542339324951172
categorical_features_race_Vec_native, 3.533456325531006
numeric_features_INJ040, 3.52453875541687
numeric_features_E01756640101, 3.516387939453125
numeric_features_E01757820101, 3.515011787414551
categorical_features_speakEnglish_Vec_no, 3.5098037719726562
categorical_features_state_Vec_KS, 3.508089542388916
numeric_features_E01755350101, 3.502229690551758
numeric_features_PM041O, 3.500900983810425
numeric_features_E01755760202, 3.485440492630005
categorical_features_race_Vec_hawaiian, 3.483919858932495
categorical_features_race_Vec_hispanic, 3.482571840286255
numeric_features_NEO042, 3.4763600826263428
numeric_features_NEO014, 3.4694061279296875
numeric_features_E01755570101, 3.4617233276367188
numeric_features_E01754890201, 3.4616215229034424
numeric_features_E01821590101, 3.458570957183838
numeric_features_RSP013, 3.4563093185424805
numeric_features_END013, 3.450611114501953
numeric_features_E01759730101, 3.4501571655273438
numeric_features_EXT018, 3.446852684020996
numeric_features_TA002N, 3.443023681640625
numeric_features_EE007N, 3.4429244995117188
numeric_features_E01754940101, 3.442267417907715
categorical_features_state_Vec_VA, 3.4407806396484375
numeric_features_E01754850101, 3.438427448272705
numeric_features_INJ052, 3.433419942855835
numeric_features_54, 3.4280548095703125
numeric_features_E01759040101, 3.4275894165039062
numeric_features_MUS026, 3.4273529052734375
numeric_features_PV030M, 3.4174437522888184
numeric_features_PM039M, 3.415874481201172
numeric_features_PO000M, 3.4156768321990967
numeric_features_EV006N, 3.411670684814453
numeric_features_E01756820501, 3.410566568374634
numeric_features_45, 3.4102249145507812
numeric_features_E01754990101, 3.409346103668213
categorical_features_houseSize_Vec_missing, 3.398101806640625
numeric_features_MUS034, 3.3928890228271484
numeric_features_EI003N, 3.3833868503570557
numeric_features_E01757810101, 3.3818840980529785
numeric_features_03, 3.381075143814087
numeric_features_E01756800101, 3.3779964447021484
numeric_features_A6, 3.375200033187866
numeric_features_E01755390101, 3.365135908126831
numeric_features_78, 3.36444091796875
numeric_features_E01826350101, 3.362166166305542
numeric_features_E01756340101, 3.3567821979522705
numeric_features_RI015N, 3.3542511463165283
numeric_features_E01754910101, 3.350466251373291
numeric_features_E01758090101, 3.3462307453155518
numeric_features_PG006M, 3.3462228775024414
numeric_features_E01756550201, 3.3458938598632812
numeric_features_NEO004, 3.3414764404296875
numeric_features_DIG008, 3.340510129928589
numeric_features_FAC003, 3.3384032249450684
numeric_features_E01838960401, 3.3377914428710938
categorical_features_state_Vec_MS, 3.3370540142059326
numeric_features_73, 3.336726665496826
numeric_features_E01754800101, 3.3336079120635986
numeric_features_E01756670101, 3.333533525466919
categorical_features_state_Vec_WY, 3.3240737915039062
numeric_features_NEO063, 3.323902130126953
numeric_features_E01756250101, 3.321150779724121
numeric_features_NEO029, 3.320737600326538
numeric_features_RX034N, 3.3200721740722656
numeric_features_E01755900101, 3.317230224609375
numeric_features_E01756790101, 3.3114960193634033
numeric_features_NVS021, 3.3071117401123047
numeric_features_E01758870101, 3.2976765632629395
numeric_features_EYE002, 3.2962894439697266
numeric_features_57, 3.2954864501953125
numeric_features_NEO057, 3.2948641777038574
numeric_features_E01756690101, 3.2941184043884277
numeric_features_E01754290101, 3.29338002204895
numeric_features_INJ008, 3.2881717681884766
numeric_features_PV005M, 3.2860515117645264
numeric_features_EXT025, 3.2837941646575928
numeric_features_PC003M, 3.280472993850708
numeric_features_E01754190101, 3.279909610748291
numeric_features_E01912610101, 3.278951644897461
numeric_features_E01758140101, 3.2763288021087646
categorical_features_state_Vec_SC, 3.276055335998535
numeric_features_E01783690101, 3.275803565979004
numeric_features_A8, 3.274524450302124
numeric_features_INJ004, 3.265753746032715
numeric_features_E01755620101, 3.2648239135742188
numeric_features_E01839050101, 3.264418363571167
numeric_features_OA003N, 3.2635180950164795
numeric_features_PE035O, 3.2632088661193848
numeric_features_E01754810101, 3.2614073753356934
numeric_features_NEO001, 3.260711669921875
numeric_features_E01850100101, 3.259213447570801
numeric_features_E01754820201, 3.258589744567871
categorical_features_ssi_Vec_missing, 3.2542457580566406
numeric_features_PO022M, 3.253218412399292
numeric_features_18, 3.2517623901367188
numeric_features_EYE003, 3.251032829284668
numeric_features_W00000170101, 3.2468185424804688
numeric_features_DD000N, 3.2436952590942383
numeric_features_86, 3.240666151046753
numeric_features_TC010N, 3.236100435256958
numeric_features_PS051O, 3.235081672668457
numeric_features_87, 3.2261486053466797
numeric_features_IM009N, 3.223712682723999
numeric_features_E01754670101, 3.2226877212524414
numeric_features_PV000M, 3.2163572311401367
numeric_features_NVS020, 3.2148361206054688
numeric_features_INJ065, 3.2132644653320312
numeric_features_E01838960501, 3.213012218475342
categorical_features_state_Vec_WI, 3.208235502243042
numeric_features_PO045O, 3.2044382095336914
categorical_features_married_Vec_missing, 3.2002415657043457
numeric_features_A4, 3.1981124877929688
numeric_features_EE000N, 3.1963469982147217
numeric_features_PRG005, 3.1955509185791016
numeric_features_E01755610202, 3.1947407722473145
categorical_features_fedPovLine_Vec_100To200, 3.1919474601745605
numeric_features_PM000M, 3.1881937980651855
numeric_features_NEO020, 3.1843364238739014
numeric_features_RX027N, 3.18426513671875
numeric_features_E01754270101, 3.1789469718933105
numeric_features_EB000N, 3.174221992492676
numeric_features_E01758450101, 3.1731815338134766
numeric_features_E01756080101, 3.1717262268066406
categorical_features_UsCitizen_Vec_no, 3.1697707176208496
numeric_features_E01754890101, 3.169241428375244
numeric_features_E01910010301, 3.1687850952148438
numeric_features_E01826390201, 3.166276216506958
numeric_features_E01755980101, 3.166095733642578
numeric_features_E01783740101, 3.16434383392334
numeric_features_49, 3.164052963256836
numeric_features_A2, 3.1639676094055176
numeric_features_PM014M, 3.1620609760284424
numeric_features_W00001040101, 3.16143798828125
numeric_features_E01754180101, 3.1511054039001465
numeric_features_INJ033, 3.1498682498931885
numeric_features_INF006, 3.149141788482666
numeric_features_EYE012, 3.147653579711914
numeric_features_71, 3.147203207015991
categorical_features_race_Vec_missing, 3.145472526550293
numeric_features_E01756100101, 3.1452524662017822
numeric_features_E01758360101, 3.1441516876220703
numeric_features_NEO008, 3.1412978172302246
numeric_features_PC002M, 3.139892339706421
numeric_features_BLD007, 3.1384739875793457
numeric_features_E01758250302, 3.1371254920959473
numeric_features_PRG025, 3.137054443359375
numeric_features_INJ070, 3.132390260696411
numeric_features_NEO012, 3.1302661895751953
numeric_features_PM020M, 3.1259427070617676
numeric_features_E01759280101, 3.125361919403076
numeric_features_RSP011, 3.1222307682037354
numeric_features_E01758020101, 3.1217687129974365
numeric_features_DC000N, 3.1144561767578125
numeric_features_FAC021, 3.111898183822632
numeric_features_A7, 3.1105737686157227
numeric_features_OB005N, 3.1090757846832275
numeric_features_IM010N, 3.1090736389160156
numeric_features_RSP005, 3.108926773071289
numeric_features_E01912790101, 3.105712890625
numeric_features_TC000N, 3.1042633056640625
numeric_features_INF009, 3.099329948425293
numeric_features_E01757770101, 3.0984630584716797
numeric_features_W00000020101, 3.0960702896118164
numeric_features_E01758840101, 3.09588623046875
numeric_features_IU015N, 3.0936813354492188
numeric_features_W00001260101, 3.0936625003814697
numeric_features_MAL009, 3.092510461807251
numeric_features_IN002N, 3.0844390392303467
categorical_features_houseSize_Vec_sixorMore, 3.082113027572632
numeric_features_E01861050101, 3.0801990032196045
numeric_features_INJ010, 3.078248977661133
numeric_features_MBD014, 3.0774214267730713
numeric_features_MUS037, 3.0759174823760986
categorical_features_married_Vec_yes, 3.0758988857269287
numeric_features_E01754970101, 3.0750768184661865
numeric_features_TL004N, 3.073878288269043
numeric_features_DF000N, 3.0697708129882812
numeric_features_RSP012, 3.0650346279144287
numeric_features_RX000N, 3.064091444015503
numeric_features_E01838900101, 3.0632541179656982
numeric_features_EXT007, 3.0608596801757812
numeric_features_NEO021, 3.0601205825805664
numeric_features_E01756910202, 3.0579590797424316
numeric_features_PC003O, 3.0519816875457764
numeric_features_IC007N, 3.0519015789031982
numeric_features_E01759440101, 3.0482289791107178
numeric_features_IU018N, 3.0463294982910156
numeric_features_E01756560101, 3.045835018157959
categorical_features_ssi_Vec_yes, 3.0445175170898438
numeric_features_IS013N, 3.042342185974121
numeric_features_E01755540101, 3.0414445400238037
numeric_features_E01754430101, 3.037792205810547
numeric_features_EP000N, 3.035734176635742
numeric_features_E01759800201, 3.03572940826416
numeric_features_E01808500101, 3.0320205688476562
numeric_features_NEO073, 3.031712770462036
numeric_features_RI006N, 3.0299453735351562
numeric_features_E01758420101, 3.0296521186828613
numeric_features_EM000N, 3.026258945465088
numeric_features_EI014N, 3.026102304458618
numeric_features_EAR003, 3.0211880207061768
categorical_features_fedPovLine_Vec_200AndMore, 3.0120973587036133
numeric_features_E01757220204, 3.008068084716797
numeric_features_PS013M, 3.0061166286468506
numeric_features_RI030N, 3.005255699157715
numeric_features_E01756980101, 3.005035400390625
numeric_features_A3, 3.00288987159729
numeric_features_MUS020, 3.0009028911590576
numeric_features_90, 2.9999847412109375
numeric_features_NEO009, 2.999147891998291
numeric_features_PB000O, 2.9983065128326416
numeric_features_NEO041, 2.9980900287628174
numeric_features_RD032N, 2.9960765838623047
numeric_features_PS013O, 2.995586395263672
numeric_features_RD001N, 2.9942092895507812
numeric_features_RI025N, 2.9938485622406006
numeric_features_E01759090701, 2.9890449047088623
numeric_features_PRG013, 2.9749996662139893
numeric_features_INJ014, 2.972519636154175
numeric_features_INJ017, 2.970330238342285
numeric_features_DIG004, 2.968641996383667
numeric_features_PC018O, 2.968034505844116
numeric_features_E01855080101, 2.9678146839141846
numeric_features_DG000N, 2.966247081756592
numeric_features_INJ016, 2.9661989212036133
numeric_features_DE000N, 2.964942693710327
numeric_features_EXT016, 2.9625561237335205
numeric_features_E01756130101, 2.9620485305786133
numeric_features_IS000N, 2.9583053588867188
numeric_features_EN000N, 2.956320285797119
numeric_features_E01754200101, 2.952810764312744
numeric_features_END011, 2.9523284435272217
numeric_features_79, 2.9510579109191895
numeric_features_FAC016, 2.947230100631714
numeric_features_13, 2.945781946182251
numeric_features_TL001N, 2.94537353515625
numeric_features_EI005N, 2.9420390129089355
numeric_features_PM011O, 2.9372217655181885
numeric_features_MBD019, 2.936767578125
numeric_features_INJ035, 2.9354774951934814
numeric_features_E01759580101, 2.93475341796875
numeric_features_E01755990101, 2.9344940185546875
numeric_features_MUS004, 2.9325509071350098
numeric_features_INJ007, 2.930433988571167
numeric_features_INJ063, 2.9275503158569336
numeric_features_95, 2.926046133041382
numeric_features_NEO051, 2.925468683242798
numeric_features_E01821490301, 2.9249606132507324
numeric_features_E01754870101, 2.923720598220825
numeric_features_E01757960101, 2.922074317932129
numeric_features_PH000O, 2.9206888675689697
numeric_features_E01755700101, 2.9184207916259766
numeric_features_E01808510101, 2.914581298828125
numeric_features_98, 2.9114577770233154
numeric_features_DIG018, 2.910696268081665
numeric_features_E01754660101, 2.9098033905029297
numeric_features_MUS016, 2.9096755981445312
numeric_features_E01755030101, 2.9072084426879883
numeric_features_INJ036, 2.9068658351898193
numeric_features_EX000N, 2.9056899547576904
numeric_features_EV011N, 2.903226375579834
numeric_features_E01756410101, 2.9031388759613037
numeric_features_FAC008, 2.9028282165527344
numeric_features_91, 2.902252674102783
numeric_features_GEN019, 2.9012057781219482
numeric_features_PRG028, 2.9011924266815186
numeric_features_80, 2.8985514640808105
numeric_features_MAL006, 2.898365020751953
numeric_features_PNL001, 2.896489143371582
numeric_features_PRG006, 2.8954124450683594
numeric_features_01, 2.8916244506835938
numeric_features_END014, 2.891519069671631
numeric_features_PE000O, 2.8890163898468018
numeric_features_publicAssistRate, 2.8879122734069824
numeric_features_PM044M, 2.8872385025024414
numeric_features_MUS011, 2.886812210083008
numeric_features_MBD006, 2.886650800704956
categorical_features_state_Vec_ND, 2.886507034301758
numeric_features_E01801860101, 2.885014772415161
numeric_features_RI024N, 2.884603261947632
numeric_features_PM036O, 2.8838868141174316
numeric_features_DF010N, 2.883744716644287
numeric_features_E01756820302, 2.8809590339660645
numeric_features_INJ072, 2.877254009246826
numeric_features_END009, 2.873706817626953
numeric_features_E01758770201, 2.8732070922851562
numeric_features_E01755170101, 2.871711254119873
numeric_features_E01754280101, 2.8714540004730225
numeric_features_NEO033, 2.8711204528808594
numeric_features_MBD021, 2.8688266277313232
numeric_features_E01754130101, 2.863805055618286
numeric_features_E01758250101, 2.859002113342285
numeric_features_PO027M, 2.858333110809326
numeric_features_MBD024, 2.85135555267334
numeric_features_FAC017, 2.849271774291992
numeric_features_INJ060, 2.8491499423980713
numeric_features_NEO065, 2.8478548526763916
numeric_features_PM000O, 2.847153425216675
numeric_features_RT021N, 2.8443305492401123
numeric_features_INF007, 2.8437461853027344
numeric_features_IN008N, 2.843369960784912
numeric_features_END017, 2.8432564735412598
numeric_features_E01754770202, 2.8428497314453125
numeric_features_A0, 2.841766357421875
numeric_features_E01755740101, 2.8379554748535156
numeric_features_PM007O, 2.837083578109741
numeric_features_E01759520101, 2.833815336227417
numeric_features_EXT002, 2.8320817947387695
numeric_features_NEO028, 2.8296241760253906
numeric_features_E01758000101, 2.8261687755584717
numeric_features_DF019N, 2.8243331909179688
numeric_features_MBD022, 2.8214352130889893
numeric_features_PG047O, 2.815481185913086
categorical_features_houseSize_Vec_single, 2.814910888671875
numeric_features_E01756370101, 2.811276912689209
numeric_features_E01908540101, 2.8087663650512695
numeric_features_PM024M, 2.8087637424468994
numeric_features_DA000N, 2.8077774047851562
categorical_features_disabled_Vec_no, 2.8032336235046387
numeric_features_PG043O, 2.799217462539673
numeric_features_PG004O, 2.7964632511138916
numeric_features_EXT029, 2.7958638668060303
numeric_features_PE001O, 2.794811725616455
numeric_features_B2, 2.7945594787597656
numeric_features_E01757620101, 2.7940077781677246
numeric_features_FAC020, 2.792724132537842
numeric_features_E01754630202, 2.7907333374023438
numeric_features_PM021M, 2.7899763584136963
numeric_features_E01754880101, 2.7873761653900146
numeric_features_INJ037, 2.787152051925659
numeric_features_E01754830201, 2.781825065612793
numeric_features_INJ075, 2.7817764282226562
numeric_features_FAC009, 2.781255006790161
numeric_features_E01757790101, 2.7753281593322754
numeric_features_E01904800101, 2.773951530456543
numeric_features_24, 2.773277759552002
numeric_features_B1, 2.7725906372070312
numeric_features_EXT017, 2.772186756134033
numeric_features_11, 2.7701873779296875
numeric_features_EXT003, 2.7675390243530273
numeric_features_PV000O, 2.76491117477417
numeric_features_E01759000101, 2.7647244930267334
numeric_features_E01754660301, 2.7619590759277344
numeric_features_MUS005, 2.7593994140625
numeric_features_DIG022, 2.758941650390625
numeric_features_E01754930101, 2.7578623294830322
numeric_features_RI031N, 2.757020950317383
numeric_features_PO022O, 2.7564804553985596
numeric_features_PH034M, 2.75338077545166
numeric_features_E01757860101, 2.7509653568267822
numeric_features_INJ058, 2.748149871826172
numeric_features_E01759450101, 2.7466516494750977
numeric_features_INF010, 2.745500087738037
numeric_features_IS004N, 2.7446155548095703
numeric_features_INJ064, 2.7436575889587402
numeric_features_INF004, 2.7428171634674072
numeric_features_PM014O, 2.7426412105560303
numeric_features_E01755000101, 2.7418911457061768
numeric_features_E01754430201, 2.7415637969970703
numeric_features_INJ001, 2.7376465797424316
numeric_features_E01755790101, 2.734090805053711
numeric_features_NEO007, 2.732664108276367
numeric_features_PM039O, 2.7308380603790283
numeric_features_PO045M, 2.7304270267486572
numeric_features_EXT001, 2.7286016941070557
numeric_features_E01757230101, 2.72829532623291
categorical_features_state_Vec_VT, 2.7266933917999268
numeric_features_RSP016, 2.7264909744262695
numeric_features_OB006N, 2.7256758213043213
numeric_features_E01756910201, 2.7239487171173096
numeric_features_PNL008, 2.721933364868164
categorical_features_state_Vec_HI, 2.7203924655914307
numeric_features_SYM013, 2.7167415618896484
numeric_features_EXT005, 2.714517116546631
numeric_features_E01759490101, 2.7139384746551514
numeric_features_E01757430101, 2.7116692066192627
numeric_features_PRG029, 2.711204767227173
numeric_features_RT033N, 2.710810661315918
numeric_features_EYE005, 2.7099504470825195
numeric_features_85, 2.7085342407226562
numeric_features_IS024N, 2.708195209503174
numeric_features_TA000N, 2.703380584716797
numeric_features_INJ015, 2.697892427444458
numeric_features_25, 2.6960372924804688
numeric_features_W00000160101, 2.6943817138671875
numeric_features_DIG023, 2.694291114807129
categorical_features_houseSize_Vec_twoToFive, 2.6926753520965576
numeric_features_E01802920101, 2.692657470703125
numeric_features_RD028N, 2.6924054622650146
numeric_features_E01755260101, 2.692256450653076
numeric_features_IN000N, 2.688943386077881
numeric_features_PV042O, 2.688304901123047
numeric_features_E01756070101, 2.6877386569976807
numeric_features_E01758890101, 2.6855525970458984
numeric_features_EXT008, 2.6853854656219482
numeric_features_IC003N, 2.6840808391571045
numeric_features_END002, 2.683436632156372
numeric_features_E01754820101, 2.682158946990967
numeric_features_ER000N, 2.6820309162139893
numeric_features_EV000N, 2.681978464126587
numeric_features_E01757390301, 2.6798853874206543
numeric_features_E01754340101, 2.6726040840148926
numeric_features_MBD010, 2.6723520755767822
numeric_features_PG000O, 2.6722981929779053
categorical_features_ssi_Vec_no, 2.67095947265625
numeric_features_NEO036, 2.669900417327881
numeric_features_TL000N, 2.6651763916015625
numeric_features_B4, 2.661043167114258
numeric_features_E01754770301, 2.654322624206543
numeric_features_NEO061, 2.6537744998931885
numeric_features_FAC014, 2.6504664421081543
numeric_features_OB000N, 2.646183729171753
numeric_features_INJ054, 2.6450986862182617
numeric_features_E01757980101, 2.6433029174804688
numeric_features_DIG015, 2.6429316997528076
numeric_features_E01754680101, 2.637885808944702
numeric_features_E01755840101, 2.6340277194976807
numeric_features_PM020O, 2.6331541538238525
numeric_features_FAC011, 2.6317529678344727
numeric_features_E01758100101, 2.6313347816467285
numeric_features_E01755920101, 2.6300013065338135
numeric_features_70, 2.629436492919922
numeric_features_E01754860101, 2.628458261489868
numeric_features_EYE009, 2.625657796859741
numeric_features_MAL004, 2.625401020050049
numeric_features_PV019M, 2.623950719833374
numeric_features_INJ019, 2.6212751865386963
numeric_features_PRG021, 2.6208648681640625
numeric_features_E01758540101, 2.619551658630371
numeric_features_END016, 2.619206428527832
categorical_features_state_Vec_CA, 2.6168265342712402
numeric_features_PS038O, 2.61173415184021
numeric_features_PS028M, 2.608351707458496
numeric_features_76, 2.606926441192627
numeric_features_RSP015, 2.6063179969787598
numeric_features_avoid_ip, 2.6056995391845703
numeric_features_drugdeathRate, 2.6047165393829346
numeric_features_INJ006, 2.604497194290161
numeric_features_A5, 2.6036219596862793
numeric_features_EYE011, 2.602890968322754
numeric_features_GEN015, 2.601555824279785
numeric_features_GEN021, 2.601151704788208
categorical_features_state_Vec_DE, 2.600924491882324
numeric_features_INJ031, 2.600799083709717
categorical_features_speakEnglish_Vec_missing, 2.5977067947387695
numeric_features_E01754830101, 2.597198724746704
numeric_features_PM011M, 2.5969276428222656
numeric_features_E01934140101, 2.5967330932617188
numeric_features_DIG019, 2.5963821411132812
numeric_features_PC008O, 2.595560073852539
numeric_features_NEO040, 2.5873942375183105
numeric_features_E01755760204, 2.5863547325134277
numeric_features_NEO010, 2.5858240127563477
numeric_features_E01754530101, 2.5854380130767822
numeric_features_DD009N, 2.58367919921875
numeric_features_PC000O, 2.582448720932007
numeric_features_68, 2.578455924987793
numeric_features_DIG020, 2.577732801437378
numeric_features_RI005N, 2.575786590576172
numeric_features_E01754770101, 2.571798086166382
numeric_features_E01759350201, 2.57062029838562
numeric_features_E01758430101, 2.570052146911621
numeric_features_83, 2.568328857421875
numeric_features_DF011N, 2.562553644180298
numeric_features_93, 2.562084674835205
numeric_features_OA001N, 2.5615158081054688
numeric_features_PG047M, 2.5594446659088135
numeric_features_TF000N, 2.5587680339813232
numeric_features_OA004N, 2.5571932792663574
numeric_features_NEO060, 2.5525131225585938
numeric_features_CIR039, 2.551377534866333
numeric_features_MBD018, 2.550461769104004
numeric_features_MAL001, 2.5498199462890625
numeric_features_PG000M, 2.5463905334472656
numeric_features_IC006N, 2.545680284500122
numeric_features_07, 2.545337200164795
numeric_features_E01912560201, 2.54461669921875
numeric_features_RSP006, 2.540480852127075
numeric_features_NEO013, 2.534304141998291
numeric_features_INF003, 2.531385660171509
numeric_features_E01759080101, 2.531308889389038
numeric_features_E01756900201, 2.530914306640625
numeric_features_04, 2.5304534435272217
numeric_features_FAC018, 2.5264663696289062
numeric_features_72, 2.526010036468506
numeric_features_IC000N, 2.5206212997436523
numeric_features_E01914930101, 2.5121123790740967
numeric_features_E01754260101, 2.5116748809814453
numeric_features_END010, 2.511270046234131
numeric_features_E01755650401, 2.5090713500976562
numeric_features_OC000N, 2.5075042247772217
numeric_features_EXT013, 2.5023107528686523
numeric_features_E01754880201, 2.4982993602752686
numeric_features_INF008, 2.496124267578125
numeric_features_non_avoid_ip, 2.4931445121765137
numeric_features_81, 2.4906160831451416
numeric_features_IU001N, 2.488812208175659
numeric_features_EAR006, 2.4863338470458984
numeric_features_INJ034, 2.4852001667022705
numeric_features_INJ003, 2.4834022521972656
numeric_features_EH000N, 2.4830262660980225
numeric_features_CIR005, 2.482593536376953
numeric_features_NEO055, 2.482363700866699
numeric_features_E01758400101, 2.480386972427368
numeric_features_E01754700101, 2.4790594577789307
numeric_features_NEO043, 2.4747672080993652
numeric_features_PG043M, 2.4726662635803223
numeric_features_INJ028, 2.4723126888275146
numeric_features_EXT011, 2.470010995864868
numeric_features_EV004N, 2.4575743675231934
numeric_features_36, 2.4552974700927734
numeric_features_DIG001, 2.446699857711792
numeric_features_MBD012, 2.445720672607422
numeric_features_E01755720101, 2.4450905323028564
numeric_features_89, 2.443812847137451
numeric_features_E01755740303, 2.4428255558013916
categorical_features_state_Vec_ME, 2.440629720687866
numeric_features_INJ025, 2.440201997756958
numeric_features_EXT015, 2.435309648513794
categorical_features_state_Vec_MT, 2.435002565383911
numeric_features_PV005O, 2.432802200317383
numeric_features_GEN025, 2.4319229125976562
numeric_features_NVS006, 2.4307403564453125
numeric_features_PV049M, 2.4240875244140625
numeric_features_94, 2.42158842086792
numeric_features_FAC002, 2.4215781688690186
numeric_features_E01754630201, 2.421510934829712
numeric_features_E01758850101, 2.4192042350769043
numeric_features_CIR026, 2.4190099239349365
numeric_features_PM021O, 2.4100117683410645
categorical_features_state_Vec_LA, 2.4056355953216553
categorical_features_fedPovLine_Vec_missing, 2.400324583053589
numeric_features_E01758050101, 2.393463134765625
numeric_features_DF008N, 2.387538194656372
numeric_features_CIR038, 2.380321741104126
numeric_features_EYE010, 2.3800899982452393
numeric_features_DG004N, 2.373551607131958
numeric_features_NEO054, 2.370274543762207
numeric_features_NEO006, 2.3691999912261963
numeric_features_MBD004, 2.3688812255859375
numeric_features_DEN001, 2.3683295249938965
categorical_features_ssdi_Vec_yes, 2.3671035766601562
categorical_features_sex_Vec_male, 2.366213083267212
numeric_features_PM041M, 2.3654866218566895
numeric_features_FAC010, 2.3654439449310303
numeric_features_INJ061, 2.3637280464172363
numeric_features_E01783780101, 2.363201141357422
numeric_features_FAC015, 2.359633445739746
numeric_features_PE001M, 2.3542072772979736
categorical_features_state_Vec_NM, 2.3418986797332764
numeric_features_MBD003, 2.3318753242492676
numeric_features_IU014N, 2.327301025390625
numeric_features_END001, 2.3249623775482178
numeric_features_PS000M, 2.3190128803253174
numeric_features_INJ045, 2.314784049987793
numeric_features_DIG010, 2.3080036640167236
numeric_features_DIG021, 2.307413101196289
numeric_features_SYM015, 2.307122230529785
numeric_features_E01755910101, 2.3002474308013916
numeric_features_goodAirDays, 2.2960383892059326
numeric_features_PB033O, 2.2898967266082764
numeric_features_EYE008, 2.2881741523742676
numeric_features_E01757060101, 2.2845396995544434
numeric_features_NEO037, 2.2805378437042236
numeric_features_DF003N, 2.278120517730713
numeric_features_E01757570101, 2.2760066986083984
numeric_features_E01784800201, 2.2743000984191895
numeric_features_EXT014, 2.2735424041748047
numeric_features_IX017N, 2.2685108184814453
numeric_features_INJ053, 2.2684171199798584
numeric_features_MAL002, 2.2669172286987305
numeric_features_END003, 2.259047508239746
numeric_features_PC031O, 2.2559263706207275
numeric_features_E01755760206, 2.2437984943389893
numeric_features_CIR037, 2.2431130409240723
numeric_features_END012, 2.242560625076294
numeric_features_INJ076, 2.241893768310547
numeric_features_E01755650202, 2.2403652667999268
numeric_features_EXT027, 2.2392096519470215
numeric_features_DIG007, 2.231293201446533
numeric_features_TL013N, 2.2297425270080566
numeric_features_avoid_ed, 2.2287392616271973
numeric_features_RI004N, 2.2221431732177734
numeric_features_PS028O, 2.220266819000244
numeric_features_PC000M, 2.210927724838257
numeric_features_INJ047, 2.202247142791748
numeric_features_IC021N, 2.1975197792053223
numeric_features_FAC004, 2.195988178253174
numeric_features_INJ056, 2.1888375282287598
numeric_features_DE001N, 2.187164306640625
numeric_features_DIG009, 2.184451103210449
numeric_features_FAC012, 2.1791889667510986
numeric_features_PH034O, 2.1750435829162598
numeric_features_INJ039, 2.1698715686798096
numeric_features_DIG005, 2.1630935668945312
numeric_features_IS005N, 2.1613941192626953
numeric_features_PM024O, 2.1578164100646973
numeric_features_CIR033, 2.1577064990997314
numeric_features_E01755430101, 2.1533751487731934
numeric_features_DIG024, 2.1476452350616455
numeric_features_all_cause_ip, 2.1454529762268066
numeric_features_EAR005, 2.145174264907837
numeric_features_NEO023, 2.141395330429077
numeric_features_PB033M, 2.1412954330444336
numeric_features_RSP010, 2.139286994934082
numeric_features_CIR034, 2.139073610305786
numeric_features_INJ043, 2.1343884468078613
numeric_features_CIR029, 2.131337881088257
numeric_features_non_avoid_ed, 2.128870964050293
numeric_features_06, 2.126903533935547
numeric_features_E01755740201, 2.126451253890991
numeric_features_NEO035, 2.125577449798584
numeric_features_EC010N, 2.1248629093170166
numeric_features_E01754770201, 2.1226513385772705
numeric_features_TL005N, 2.120952844619751
numeric_features_E01755140101, 2.1104156970977783
numeric_features_DIG006, 2.1097500324249268
numeric_features_CIR032, 2.1006970405578613
numeric_features_CIR035, 2.090102434158325
numeric_features_DG006N, 2.088064193725586
numeric_features_PB052O, 2.083139181137085
numeric_features_E01758360201, 2.07574462890625
numeric_features_INF011, 2.0681655406951904
numeric_features_CIR031, 2.064486026763916
numeric_features_EH018N, 2.061448574066162
numeric_features_E01754890202, 2.061427593231201
numeric_features_E01756010101, 2.060723304748535
numeric_features_INJ027, 2.0592660903930664
numeric_features_IU016N, 2.0589115619659424
numeric_features_DIG011, 2.053009033203125
numeric_features_GEN001, 2.0502052307128906
numeric_features_INF005, 2.0455424785614014
numeric_features_EXT006, 2.0448946952819824
numeric_features_E01755650203, 2.038334846496582
numeric_features_FAC022, 2.038243532180786
numeric_features_100HeatDays, 2.032475233078003
numeric_features_62, 2.028665065765381
numeric_features_CIR004, 2.0136964321136475
numeric_features_PG004M, 2.0066542625427246
numeric_features_CIR030, 2.0015504360198975
numeric_features_INJ041, 1.9900801181793213
numeric_features_avoid_slope, 1.9792649745941162
categorical_features_race_Vec_asian, 1.9752788543701172
numeric_features_BLD005, 1.9747759103775024
numeric_features_E01838880101, 1.972575068473816
numeric_features_PO040O, 1.967362403869629
numeric_features_E01758380101, 1.9646527767181396
numeric_features_GEN017, 1.9638818502426147
numeric_features_INJ012, 1.9636683464050293
numeric_features_SKN003, 1.9624273777008057
numeric_features_CIR036, 1.962275743484497
numeric_features_PG012O, 1.9597506523132324
numeric_features_END015, 1.9579451084136963
numeric_features_all_cause_acute, 1.9576796293258667
numeric_features_PM015O, 1.951324224472046
numeric_features_PO000O, 1.9458484649658203
numeric_features_MBD023, 1.9458318948745728
numeric_features_INJ011, 1.9440640211105347
numeric_features_MUS003, 1.9278106689453125
numeric_features_END007, 1.9155328273773193
numeric_features_E01757200101, 1.9110044240951538
numeric_features_PV037M, 1.9061851501464844
numeric_features_MBD005, 1.9002283811569214
numeric_features_BLD006, 1.8965191841125488
numeric_features_allcause_slope, 1.8962130546569824
numeric_features_PS016M, 1.876704216003418
numeric_features_MBD026, 1.8755781650543213
numeric_features_CIR027, 1.867882251739502
numeric_features_EB009N, 1.8597863912582397
numeric_features_BLD004, 1.833418369293213
numeric_features_PO050O, 1.8279634714126587
numeric_features_NEO039, 1.8271080255508423
numeric_features_E01759110101, 1.8267310857772827
numeric_features_CIR013, 1.820095419883728
numeric_features_MAL005, 1.8111004829406738
numeric_features_E01754150101, 1.8107025623321533
numeric_features_EYE007, 1.8024654388427734
numeric_features_E01755940501, 1.7971605062484741
numeric_features_INJ026, 1.786956787109375
numeric_features_BLD002, 1.7862991094589233
numeric_features_E01755830101, 1.7850151062011719
numeric_features_CIR011, 1.7820566892623901
numeric_features_E01755660101, 1.7812055349349976
numeric_features_E01755780101, 1.7680325508117676
numeric_features_EXT019, 1.7572959661483765
numeric_features_E01754870201, 1.7466026544570923
numeric_features_INJ048, 1.7453852891921997
numeric_features_E01755620201, 1.7450329065322876
numeric_features_CIR007, 1.7400469779968262
numeric_features_CIR008, 1.739532470703125
numeric_features_CIR003, 1.723818302154541
numeric_features_CIR023, 1.7228164672851562
numeric_features_CIR028, 1.7215509414672852
numeric_features_highSchoolGradRate, 1.7186132669448853
numeric_features_CIR022, 1.710036039352417
numeric_features_EN008N, 1.6986985206604004
numeric_features_EAR004, 1.6803131103515625
numeric_features_CIR017, 1.676816463470459
numeric_features_CIR015, 1.6635987758636475
numeric_features_popDensity, 1.6599406003952026
numeric_features_INJ049, 1.6592193841934204
numeric_features_FAC007, 1.649545669555664
numeric_features_EV001N, 1.6257753372192383
numeric_features_CIR016, 1.6154001951217651
numeric_features_PE046M, 1.6096004247665405
numeric_features_E01758180201, 1.6082983016967773
numeric_features_INJ073, 1.5916614532470703
numeric_features_NEO058, 1.5866661071777344
numeric_features_NEO027, 1.5766174793243408
numeric_features_CIR019, 1.5737011432647705
numeric_features_CIR006, 1.5642220973968506
numeric_features_CIR012, 1.5627092123031616
numeric_features_all_cause_ed, 1.560242772102356
numeric_features_E01755800101, 1.5494728088378906
numeric_features_CIR018, 1.5462504625320435
numeric_features_saServRate, 1.5371348857879639
numeric_features_BLD010, 1.5185903310775757
numeric_features_MBD013, 1.5182209014892578
numeric_features_CIR025, 1.50978422164917
numeric_features_E01756590101, 1.5067501068115234
numeric_features_EYE001, 1.503657579421997
numeric_features_CIR014, 1.5036112070083618
numeric_features_aprnRate, 1.4983105659484863
numeric_features_INJ051, 1.4954581260681152
numeric_features_E01756160101, 1.4893989562988281
numeric_features_INJ066, 1.4808858633041382
numeric_features_number_of_unique_med, 1.4699187278747559
numeric_features_povRate, 1.4558862447738647
numeric_features_E01843160101, 1.4494819641113281
numeric_features_avoid_acute, 1.438699722290039
numeric_features_BLD008, 1.4250437021255493
numeric_features_NA99N, 1.40997314453125
numeric_features_BLD009, 1.4043426513671875
numeric_features_CIR024, 1.388875961303711
numeric_features_mhTreatRate, 1.3875583410263062
numeric_features_CIR010, 1.366645097732544
numeric_features_BLD003, 1.3659511804580688
numeric_features_INJ021, 1.3635669946670532
numeric_features_NEO032, 1.3503782749176025
numeric_features_percent_generic, 1.3491716384887695
numeric_features_CIR009, 1.327491283416748
numeric_features_CIR002, 1.2945561408996582
numeric_features_53, 1.2693328857421875
numeric_features_ccsr_null, 1.2634756565093994
numeric_features_urgentCareRate, 1.2633661031723022
numeric_features_BLD001, 1.2627193927764893
numeric_features_age, 1.2321901321411133
numeric_features_CIR021, 1.2157235145568848
numeric_features_FAC005, 1.2026989459991455
numeric_features_CIR020, 1.1983946561813354
numeric_features_saFacRate, 1.1977897882461548
numeric_features_MBD009, 1.1815755367279053
numeric_features_RR000N, 1.1791915893554688
numeric_features_E01841670101, 1.093619465827942
numeric_features_MUS019, 1.0730018615722656
numeric_features_CIR001, 1.06432044506073
numeric_features_pharm_slope, 0.9282436370849609
numeric_features_injDeathRate, 0.9244938492774963
numeric_features_PV030O, 0.8787646293640137
numeric_features_E01759340101, 0.8664474487304688
numeric_features_EXT012, 0.7597136497497559
numeric_features_EH017N, 0.037456512451171875
numeric_features_E01757120101, 0.026035308837890625
numeric_features_INJ050, 0.0207974910736084
numeric_features_E01757590101, 0.0183868408203125
numeric_features_Z2, 0.014019489288330078
numeric_features_SYM001, 0.010450363159179688

"""

#input_data = [f'"{x.strip()}"' for x in input_data.strip().split('\n') if x.strip()]
input_data = [x.strip() for x in input_data.strip().split('\n') if x.strip()]
print(input_data)

# COMMAND ----------

matches1 = [x for x in input_data if x.split(', ')[0] not in comparison]

def safe_sort_key(x):
    parts = x.split(', ')
    if len(parts) > 1:
        try:
            return float(parts[1])
        except ValueError:
            return float('-inf')  # or another appropriate default value
    else:
        return float('-inf')  # or another appropriate default value

matches1.sort(key=safe_sort_key, reverse=True)

matches1 = matches1[:30]

for match in matches1:
    feature, value = match.split(', ')
    print(f"{feature}, {float(value):.2f}")

# COMMAND ----------

# create a DataFrame from the matches1 list
from pyspark.sql.types import StructType, StructField, StringType, IntegerType
from pyspark.sql.types import FloatType
from pyspark.sql.functions import round

# define the schema
schema = StructType([
    StructField("feature", StringType(), True),
    StructField("raw_value", FloatType(), True)
])

df = spark.createDataFrame([(x.split(", ")[0], float(x.split(", ")[1])) for x in matches1], schema)
df.show()

# COMMAND ----------

def is_float(s):
    try:
        float(s)
        return True
    except ValueError:
        return False

max_value = max(float(x.split(', ')[1]) for x in input_data if len(x.split(', ')) > 1 and is_float(x.split(', ')[1]))
print(max_value)

# COMMAND ----------

df = df.withColumn("scaled_value", df["raw_value"] / max_value)
df = df.withColumn("raw_value", round(df["raw_value"], 2)).withColumn("scaled_value", round(df["scaled_value"], 2))
df.show(truncate=False)

# COMMAND ----------

from pyspark.sql.functions import col

# Filter the DataFrame
df = df.filter(col('feature').startswith('numeric_features'))

# Show the resulting DataFrame
df.show(truncate=False, n=30)

# COMMAND ----------

print(df.count())

# COMMAND ----------

df.write.saveAsTable("dua_058828_spa240.paper_4_pbd_non_sdoh_feature_imp", mode="overwrite")


# COMMAND ----------

